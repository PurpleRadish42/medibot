<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up - MedBot AI</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .auth-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            width: 100%;
            max-width: 1000px;
            min-height: 700px;
            display: flex;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .auth-left {
            flex: 1;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 3rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .auth-left::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="%23ffffff" opacity="0.1"/><circle cx="75" cy="75" r="1" fill="%23ffffff" opacity="0.1"/><circle cx="25" cy="75" r="0.5" fill="%23ffffff" opacity="0.1"/><circle cx="75" cy="25" r="0.5" fill="%23ffffff" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            animation: float 20s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        .auth-logo {
            font-size: 4rem;
            margin-bottom: 1rem;
            position: relative;
            z-index: 2;
        }

        .auth-left h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            position: relative;
            z-index: 2;
        }

        .auth-left p {
            font-size: 1.1rem;
            opacity: 0.9;
            line-height: 1.6;
            position: relative;
            z-index: 2;
        }

        .auth-right {
            flex: 1.2;
            padding: 3rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            max-height: 700px;
            overflow-y: auto;
        }

        .auth-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .auth-header h2 {
            color: #374151;
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .auth-header p {
            color: #6b7280;
            font-size: 1rem;
        }

        .form-row {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
            flex: 1;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            color: #374151;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .form-input {
            width: 100%;
            padding: 1rem 1.5rem;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: #f9fafb;
        }

        .form-input:focus {
            outline: none;
            border-color: #4facfe;
            background: white;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
            transform: translateY(-1px);
        }

        .form-input::placeholder {
            color: #9ca3af;
        }

        .form-input.error {
            border-color: #ef4444;
            background: #fef2f2;
        }

        .form-input.success {
            border-color: #10b981;
            background: #f0fdf4;
        }

        .password-input-container {
            position: relative;
        }

        .password-toggle {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #6b7280;
            cursor: pointer;
            font-size: 1.1rem;
            transition: color 0.3s ease;
        }

        .password-toggle:hover {
            color: #4facfe;
        }

        .password-strength {
            margin-top: 0.5rem;
            display: none;
        }

        .strength-bar {
            height: 4px;
            background: #e5e7eb;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .strength-fill {
            height: 100%;
            transition: all 0.3s ease;
            width: 0%;
        }

        .strength-weak { background: #ef4444; width: 25%; }
        .strength-fair { background: #f59e0b; width: 50%; }
        .strength-good { background: #3b82f6; width: 75%; }
        .strength-strong { background: #10b981; width: 100%; }

        .strength-text {
            font-size: 0.8rem;
            color: #6b7280;
        }

        .field-validation {
            font-size: 0.8rem;
            margin-top: 0.5rem;
            display: none;
        }

        .field-validation.error {
            color: #ef4444;
            display: block;
        }

        .field-validation.success {
            color: #10b981;
            display: block;
        }

        .terms-checkbox {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            margin-bottom: 2rem;
            font-size: 0.9rem;
            color: #6b7280;
            line-height: 1.5;
        }

        .terms-checkbox input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #4facfe;
            margin-top: 0.1rem;
            flex-shrink: 0;
        }

        .terms-checkbox a {
            color: #4facfe;
            text-decoration: none;
        }

        .terms-checkbox a:hover {
            text-decoration: underline;
        }

        .submit-btn {
            width: 100%;
            padding: 1rem 2rem;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .submit-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(79, 172, 254, 0.3);
        }

        .submit-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }

        .submit-btn .loading-spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 2px solid transparent;
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 0.5rem;
        }

        .submit-btn.loading .loading-spinner {
            display: inline-block;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .auth-divider {
            text-align: center;
            margin: 2rem 0;
            position: relative;
            color: #6b7280;
        }

        .auth-divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: #e5e7eb;
        }

        .auth-divider span {
            background: white;
            padding: 0 1rem;
        }

        .auth-switch {
            text-align: center;
            color: #6b7280;
        }

        .auth-switch a {
            color: #4facfe;
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s ease;
        }

        .auth-switch a:hover {
            color: #0284c7;
        }

        .alert {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: none;
            animation: slideIn 0.3s ease;
        }

        .alert-error {
            background: #fef2f2;
            color: #dc2626;
            border: 1px solid #fecaca;
        }

        .alert-success {
            background: #f0fdf4;
            color: #16a34a;
            border: 1px solid #bbf7d0;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .medical-icons {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
        }

        .medical-icon {
            position: absolute;
            color: rgba(255, 255, 255, 0.1);
            animation: floatIcon 15s linear infinite;
        }

        .medical-icon:nth-child(1) { left: 10%; animation-delay: 0s; }
        .medical-icon:nth-child(2) { left: 20%; animation-delay: 3s; }
        .medical-icon:nth-child(3) { left: 30%; animation-delay: 6s; }
        .medical-icon:nth-child(4) { left: 80%; animation-delay: 9s; }
        .medical-icon:nth-child(5) { left: 90%; animation-delay: 12s; }

        @keyframes floatIcon {
            0% { transform: translateY(100vh) rotate(0deg); }
            100% { transform: translateY(-100px) rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .auth-container {
                flex-direction: column;
                max-width: 400px;
                min-height: auto;
            }

            .auth-left {
                padding: 2rem;
                min-height: 200px;
            }

            .auth-left h1 {
                font-size: 1.8rem;
            }

            .auth-logo {
                font-size: 3rem;
            }

            .auth-right {
                padding: 2rem;
                max-height: none;
            }

            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }
    </style>
</head>
<body>
    <div class="auth-container">
        <div class="auth-left">
            <div class="medical-icons">
                <div class="medical-icon" style="font-size: 2rem;"><i class="fas fa-heartbeat"></i></div>
                <div class="medical-icon" style="font-size: 1.5rem;"><i class="fas fa-stethoscope"></i></div>
                <div class="medical-icon" style="font-size: 2.5rem;"><i class="fas fa-pills"></i></div>
                <div class="medical-icon" style="font-size: 1.8rem;"><i class="fas fa-user-md"></i></div>
                <div class="medical-icon" style="font-size: 2rem;"><i class="fas fa-hospital"></i></div>
            </div>
            <div class="auth-logo">
                <i class="fas fa-user-plus"></i>
            </div>
            <h1>Join MedBot AI</h1>
            <p>Create your account and start your personalized healthcare journey. Get access to AI-powered medical assistance and personalized health insights.</p>
        </div>

        <div class="auth-right">
            <div class="auth-header">
                <h2>Create Account</h2>
                <p>Fill in your details to get started</p>
            </div>

            <div class="alert alert-error" id="errorAlert"></div>
            <div class="alert alert-success" id="successAlert"></div>

            <form id="registerForm" onsubmit="handleRegister(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label for="fullName" class="form-label">
                            <i class="fas fa-user"></i> Full Name
                        </label>
                        <input 
                            type="text" 
                            id="fullName" 
                            name="fullName" 
                            class="form-input" 
                            placeholder="Enter your full name"
                            required
                            autocomplete="name"
                            oninput="validateField('fullName')"
                        >
                        <div class="field-validation" id="fullNameValidation"></div>
                    </div>

                    <div class="form-group">
                        <label for="username" class="form-label">
                            <i class="fas fa-at"></i> Username
                        </label>
                        <input 
                            type="text" 
                            id="username" 
                            name="username" 
                            class="form-input" 
                            placeholder="Choose a username"
                            required
                            autocomplete="username"
                            oninput="validateField('username')"
                        >
                        <div class="field-validation" id="usernameValidation"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="email" class="form-label">
                        <i class="fas fa-envelope"></i> Email Address
                    </label>
                    <input 
                        type="email" 
                        id="email" 
                        name="email" 
                        class="form-input" 
                        placeholder="Enter your email address"
                        required
                        autocomplete="email"
                        oninput="validateField('email')"
                    >
                    <div class="field-validation" id="emailValidation"></div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="password" class="form-label">
                            <i class="fas fa-lock"></i> Password
                        </label>
                        <div class="password-input-container">
                            <input 
                                type="password" 
                                id="password" 
                                name="password" 
                                class="form-input" 
                                placeholder="Create a strong password"
                                required
                                autocomplete="new-password"
                                oninput="validatePassword()"
                            >
                            <button type="button" class="password-toggle" onclick="togglePassword('password')">
                                <i class="fas fa-eye" id="passwordToggleIcon"></i>
                            </button>
                        </div>
                        <div class="password-strength" id="passwordStrength">
                            <div class="strength-bar">
                                <div class="strength-fill" id="strengthFill"></div>
                            </div>
                            <div class="strength-text" id="strengthText"></div>
                        </div>
                        <div class="field-validation" id="passwordValidation"></div>
                    </div>

                    <div class="form-group">
                        <label for="confirmPassword" class="form-label">
                            <i class="fas fa-lock"></i> Confirm Password
                        </label>
                        <div class="password-input-container">
                            <input 
                                type="password" 
                                id="confirmPassword" 
                                name="confirmPassword" 
                                class="form-input" 
                                placeholder="Confirm your password"
                                required
                                autocomplete="new-password"
                                oninput="validateField('confirmPassword')"
                            >
                            <button type="button" class="password-toggle" onclick="togglePassword('confirmPassword')">
                                <i class="fas fa-eye" id="confirmPasswordToggleIcon"></i>
                            </button>
                        </div>
                        <div class="field-validation" id="confirmPasswordValidation"></div>
                    </div>
                </div>

                <div class="terms-checkbox">
                    <input type="checkbox" id="agreeTerms" name="agreeTerms" required>
                    <label for="agreeTerms">
                        I agree to the <a href="#" onclick="showTerms()">Terms of Service</a> and 
                        <a href="#" onclick="showPrivacy()">Privacy Policy</a>. I understand that this 
                        medical AI assistant is for informational purposes only and should not replace 
                        professional medical advice.
                    </label>
                </div>

                <button type="submit" class="submit-btn" id="submitBtn">
                    <div class="loading-spinner"></div>
                    <span>Create Account</span>
                </button>
            </form>

            <div class="auth-divider">
                <span>or</span>
            </div>

            <div class="auth-switch">
                Already have an account? <a href="/login">Sign in here</a>
            </div>
        </div>
    </div>

    <script>
        let validationState = {
            fullName: false,
            username: false,
            email: false,
            password: false,
            confirmPassword: false
        };

        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            const icon = document.getElementById(inputId + 'ToggleIcon');
            
            if (input.type === 'password') {
                input.type = 'text';
                icon.className = 'fas fa-eye-slash';
            } else {
                input.type = 'password';
                icon.className = 'fas fa-eye';
            }
        }

        function showAlert(message, type) {
            const alertElement = document.getElementById(type + 'Alert');
            alertElement.textContent = message;
            alertElement.style.display = 'block';
            
            // Hide other alert
            const otherType = type === 'error' ? 'success' : 'error';
            document.getElementById(otherType + 'Alert').style.display = 'none';
            
            // Auto hide after 5 seconds
            setTimeout(() => {
                alertElement.style.display = 'none';
            }, 5000);
        }

        function setFieldState(fieldId, isValid, message) {
            const input = document.getElementById(fieldId);
            const validation = document.getElementById(fieldId + 'Validation');
            
            input.classList.remove('error', 'success');
            validation.classList.remove('error', 'success');
            
            if (message) {
                if (isValid) {
                    input.classList.add('success');
                    validation.classList.add('success');
                } else {
                    input.classList.add('error');
                    validation.classList.add('error');
                }
                validation.textContent = message;
            } else {
                validation.style.display = 'none';
            }
            
            validationState[fieldId] = isValid;
        }

        function validateField(fieldId) {
            const input = document.getElementById(fieldId);
            const value = input.value.trim();

            switch (fieldId) {
                case 'fullName':
                    if (value.length < 2) {
                        setFieldState(fieldId, false, 'Full name must be at least 2 characters');
                    } else if (!/^[a-zA-Z\s]+$/.test(value)) {
                        setFieldState(fieldId, false, 'Full name can only contain letters and spaces');
                    } else {
                        setFieldState(fieldId, true, '✓ Valid full name');
                    }
                    break;

                case 'username':
                    if (value.length < 3) {
                        setFieldState(fieldId, false, 'Username must be at least 3 characters');
                    } else if (!/^[a-zA-Z0-9_]+$/.test(value)) {
                        setFieldState(fieldId, false, 'Username can only contain letters, numbers, and underscores');
                    } else {
                        setFieldState(fieldId, true, '✓ Valid username');
                    }
                    break;

                case 'email':
                    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    if (!emailRegex.test(value)) {
                        setFieldState(fieldId, false, 'Please enter a valid email address');
                    } else {
                        setFieldState(fieldId, true, '✓ Valid email address');
                    }
                    break;

                case 'confirmPassword':
                    const password = document.getElementById('password').value;
                    if (value !== password) {
                        setFieldState(fieldId, false, 'Passwords do not match');
                    } else if (value.length > 0) {
                        setFieldState(fieldId, true, '✓ Passwords match');
                    } else {
                        setFieldState(fieldId, false, '');
                    }
                    break;
            }
        }

        function validatePassword() {
            const password = document.getElementById('password').value;
            const strengthEl = document.getElementById('passwordStrength');
            const fillEl = document.getElementById('strengthFill');
            const textEl = document.getElementById('strengthText');
            
            if (password.length === 0) {
                strengthEl.style.display = 'none';
                setFieldState('password', false, '');
                return;
            }
            
            strengthEl.style.display = 'block';
            
            // Simple length-based validation
            if (password.length < 8) {
                fillEl.className = 'strength-fill strength-weak';
                textEl.textContent = 'Too short';
                setFieldState('password', false, 'Password must be at least 8 characters');
            } else if (password.length < 12) {
                fillEl.className = 'strength-fill strength-fair';
                textEl.textContent = 'Good length';
                setFieldState('password', true, '✓ Valid password');
            } else {
                fillEl.className = 'strength-fill strength-strong';
                textEl.textContent = 'Strong password';
                setFieldState('password', true, '✓ Strong password');
            }
            
            // Revalidate confirm password
            if (document.getElementById('confirmPassword').value) {
                validateField('confirmPassword');
            }
        }

        function setLoading(loading) {
            const submitBtn = document.getElementById('submitBtn');
            const form = document.getElementById('registerForm');
            
            if (loading) {
                submitBtn.classList.add('loading');
                submitBtn.disabled = true;
                form.style.pointerEvents = 'none';
            } else {
                submitBtn.classList.remove('loading');
                submitBtn.disabled = false;
                form.style.pointerEvents = 'auto';
            }
        }

        async function handleRegister(event) {
            event.preventDefault();
            
            // Final validation
            const inputs = ['fullName', 'username', 'email', 'password', 'confirmPassword'];
            inputs.forEach(validateField);
            validatePassword();
            
            const allValid = Object.values(validationState).every(isValid => isValid);
            const agreeTerms = document.getElementById('agreeTerms').checked;
            
            if (!allValid) {
                showAlert('Please fix the errors in the form before submitting', 'error');
                return;
            }
            
            if (!agreeTerms) {
                showAlert('Please agree to the terms and conditions', 'error');
                return;
            }

            const formData = new FormData(event.target);
            const userData = {
                fullName: formData.get('fullName').trim(),
                username: formData.get('username').trim(),
                email: formData.get('email').trim(),
                password: formData.get('password')
            };

            setLoading(true);

            try {
                const response = await fetch('/api/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(userData)
                });

                const data = await response.json();

                if (data.success) {
                    showAlert('Account created successfully! Redirecting to login...', 'success');
                    
                    // Redirect to login after short delay
                    setTimeout(() => {
                        window.location.href = '/login';
                    }, 2000);
                } else {
                    showAlert(data.message || 'Registration failed. Please try again.', 'error');
                }
            } catch (error) {
                console.error('Registration error:', error);
                showAlert('Network error. Please check your connection and try again.', 'error');
            } finally {
                setLoading(false);
            }
        }

        function showTerms() {
            alert('Terms of Service:\n\n1. This is a medical AI assistant for informational purposes only\n2. Do not use for emergency medical situations\n3. Always consult healthcare professionals for medical advice\n4. We are not liable for any medical decisions based on AI responses');
        }

        function showPrivacy() {
            alert('Privacy Policy:\n\n1. Your personal information is encrypted and secure\n2. Medical conversations are private and confidential\n3. We do not share your data with third parties\n4. You can delete your account and data at any time');
        }

        // Auto-focus on first input
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('fullName').focus();
        });
    </script>
</body>
</html>